{
    "commands": [
        {
            "description": "Append helm_sets string with enable traces Helm set",
            "run": [
                "echo \"Creating enable metrics Helm set...\";",
                "helm_set=\"--set logzio-k8s-telemetry.traces.enabled=true\";",
                "helm_sets+=\" $helm_set\";"
            ]
        },
        {
            "description": "Append helm_sets string with Logz.io traces token Helm set",
            "run": [
                "echo \"Getting Logz.io traces token...\";",
                "shipping_token=$(echo \"$APP_JSON\" | jq -r \".shippingTokens.TRACING\");",
                "echo \"Creating Logz.io traces token Helm set...\";",
                "helm_set=\"--set logzio-k8s-telemetry.secrets.TracesToken=$shipping_token\";",
                "helm_sets+=\" $helm_set\";"
            ]
        },
        {
            "description": "Append helm_sets string with Logz.io region Helm set",
            "run": [
                "echo \"Getting Logz.io region...\";",
                "listener_url=$(echo \"$APP_JSON\" | jq -r \".listenerUrl\");",
                "region=\"us\";",
                "if [[ \"$listener_url\" = *\"-\"* ]]; then",
                    "listener_part=$(cut -d \".\" -f1 <<< \"$listener_url\");",
                    "region=$(cut -d \"-\" -f2 <<< \"$listener_part\");",
                "fi;",
                "echo \"$region\";",
                "echo \"Creating logzio region Helm set...\";",
                "helm_set=\"--set secrets.LogzioRegion=$region\";",
                "helm_sets+=\" $helm_set\";"
            ]
        }
    ]
}