{
    "commands": [
        {
            "description": "Create boolean variable for is logs option selected",
            "run": [
                "isLogsOptionSelected=true;",
                "logsParams=$(jq -r \".subtype.datasources[0].telemetries[0].params\" $appJson);"
            ]
        },
        {
            "description": "Is logs option selected?",
            "run": [
                "if [ \"$logsParams\" == [] ]; then",
                    "isLogsOptionSelected=false;",
                    "echo \"Logs option was not selected\";",
                "else",
                    "echo \"Logs option was selected\";",
                "fi;"
            ]
        },
        {
            "description": "Append Helm set for Logz.io logs listener to helmSets string",
            "run": [
                "if [ isLogsOptionSelected ]; then",
                    "echo \"Getting Logz.io logs listener...\";",
                    "logzioLogsListenerParam=\"\";",
                    "while read -r param; do",
                        "name=$(echo \"$param\" | jq -r \".name\");",
                        "if [ $name != \"logzioLogsListener\" ]; then",
                            "continue;",
                        "fi;",
                        "logzioLogsListenerParam=$param;",
                        "break;",
                    "done < <(echo \"$logsParams\" | jq -c \".[]\");",
                    "value=$(echo \"$logzioLogsListenerParam\" | jq -r \".value\");",
                    "echo \"Creating Helm set...\";",
                    "helmSet=\"--set secrets.logzioLogsListener=\\'$value\\'\";",
                    "helmSets+=\" $helmSet\";",
                "fi;"
            ]
        },
        {
            "description": "Append Helm set for Logz.io logs token to helmSets string",
            "run": [
                "if [ isLogsOptionSelected ]; then",
                    "echo \"Getting Logz.io metrics token...\";",
                    "logzioLogsTokenParam=\"\";",
                    "while read -r param; do",
                        "name=$(echo \"$param\" | jq -r \".name\");",
                        "if [ $name != \"logzioLogsToken\" ]; then",
                            "continue;",
                        "fi;",
                        "logzioLogsTokenParam=$param;",
                        "break;",
                    "done < <(echo \"$logsParams\" | jq -c \".[]\");",
                    "value=$(echo \"$logzioLogsTokenParam\" | jq -r \".value\");",
                    "echo \"Creating Helm set...\";",
                    "helmSet=\"--set secrets.logzioLogsToken=\\'$value\\'\";",
                    "helmSets+=\" $helmSet\";",
                "fi;"
            ]
        }
    ]
}